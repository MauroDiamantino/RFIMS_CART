<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RFIMS-CART: SpectranInterface Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CART-1_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RFIMS-CART
   </div>
   <div id="projectbrief">This software was designed to capture RF power measurements from a spectrum analyzer Aaronia Spectran V4, using an antenna which could be rotated to point the horizon in different azimuth angles and whose polarization could be changed between horizontal and vertical. A sweep from 1 GHz (or maybe less) to 9.4 GHz is captured in each antenna position and then it is calibrated, it is processed to identify RF interference (RFI), it is saved into memory, it is plotted with the detected RFI and finally the measurements are sent to a remote server.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classSpectranInterface-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SpectranInterface Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The aim of this class is to manage the communication with the Aaronia Spectran device.  
 <a href="classSpectranInterface.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Spectran_8h_source.html">Spectran.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9ace3807dcbbf01313890871d6a60f51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a9ace3807dcbbf01313890871d6a60f51">SpectranInterface</a> ()</td></tr>
<tr class="memdesc:a9ace3807dcbbf01313890871d6a60f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default class constructor.  <a href="#a9ace3807dcbbf01313890871d6a60f51">More...</a><br /></td></tr>
<tr class="separator:a9ace3807dcbbf01313890871d6a60f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52592fb5fe9d7734d869540826b47325"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a52592fb5fe9d7734d869540826b47325">~SpectranInterface</a> ()</td></tr>
<tr class="memdesc:a52592fb5fe9d7734d869540826b47325"><td class="mdescLeft">&#160;</td><td class="mdescRight">The class destructor.  <a href="#a52592fb5fe9d7734d869540826b47325">More...</a><br /></td></tr>
<tr class="separator:a52592fb5fe9d7734d869540826b47325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d4a40c802f909b19014a5bfdac7db5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a29d4a40c802f909b19014a5bfdac7db5">Initialize</a> ()</td></tr>
<tr class="memdesc:a29d4a40c802f909b19014a5bfdac7db5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method logs in with the spectrum analyzer, once the communication has been opened and its parameters has been set up.  <a href="#a29d4a40c802f909b19014a5bfdac7db5">More...</a><br /></td></tr>
<tr class="separator:a29d4a40c802f909b19014a5bfdac7db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b64b69e1d99723fea1fd9c112dcfda"><td class="memItemLeft" align="right" valign="top"><a id="a31b64b69e1d99723fea1fd9c112dcfda"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a31b64b69e1d99723fea1fd9c112dcfda">Available</a> ()</td></tr>
<tr class="memdesc:a31b64b69e1d99723fea1fd9c112dcfda"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns the number of available bytes in the input buffer. <br /></td></tr>
<tr class="separator:a31b64b69e1d99723fea1fd9c112dcfda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a512218c4f1589c32b4fd9a0f7ad5e8cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a512218c4f1589c32b4fd9a0f7ad5e8cc">ResetSweep</a> ()</td></tr>
<tr class="memdesc:a512218c4f1589c32b4fd9a0f7ad5e8cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is intended to restore the streaming of sweep points to the first point which corresponds to the initial frequency (Fstart).  <a href="#a512218c4f1589c32b4fd9a0f7ad5e8cc">More...</a><br /></td></tr>
<tr class="separator:a512218c4f1589c32b4fd9a0f7ad5e8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac812a1bcaede6504f62cc544c30fffea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#ac812a1bcaede6504f62cc544c30fffea">EnableSweep</a> ()</td></tr>
<tr class="memdesc:ac812a1bcaede6504f62cc544c30fffea"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method allows to enable the streaming of sweep points.  <a href="#ac812a1bcaede6504f62cc544c30fffea">More...</a><br /></td></tr>
<tr class="separator:ac812a1bcaede6504f62cc544c30fffea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b1b1a6af802369cb146c69161d031d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a68b1b1a6af802369cb146c69161d031d">DisableSweep</a> ()</td></tr>
<tr class="memdesc:a68b1b1a6af802369cb146c69161d031d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method allows to disable the streaming of sweep points.  <a href="#a68b1b1a6af802369cb146c69161d031d">More...</a><br /></td></tr>
<tr class="separator:a68b1b1a6af802369cb146c69161d031d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67de35ac5416ab4e7880ee03fcd2884e"><td class="memItemLeft" align="right" valign="top"><a id="a67de35ac5416ab4e7880ee03fcd2884e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a67de35ac5416ab4e7880ee03fcd2884e">Purge</a> ()</td></tr>
<tr class="memdesc:a67de35ac5416ab4e7880ee03fcd2884e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method purges the input buffer. <br /></td></tr>
<tr class="separator:a67de35ac5416ab4e7880ee03fcd2884e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59eff163ecf77f55bba22f49ef79d909"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a59eff163ecf77f55bba22f49ef79d909">SoftReset</a> ()</td></tr>
<tr class="memdesc:a59eff163ecf77f55bba22f49ef79d909"><td class="mdescLeft">&#160;</td><td class="mdescRight">The soft reset is performed using the function <code>FT_ResetDevice()</code> of the driver D2XX.  <a href="#a59eff163ecf77f55bba22f49ef79d909">More...</a><br /></td></tr>
<tr class="separator:a59eff163ecf77f55bba22f49ef79d909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ee786fb582c5db42253ec0c96f3b8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a44ee786fb582c5db42253ec0c96f3b8e">HardReset</a> ()</td></tr>
<tr class="memdesc:a44ee786fb582c5db42253ec0c96f3b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The hard reset implies that the spectrum analyzer is turned off and then it is turned on again.  <a href="#a44ee786fb582c5db42253ec0c96f3b8e">More...</a><br /></td></tr>
<tr class="separator:a44ee786fb582c5db42253ec0c96f3b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8884f03d3075589a2850c83c9fd57e72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a8884f03d3075589a2850c83c9fd57e72">LogOut</a> ()</td></tr>
<tr class="memdesc:a8884f03d3075589a2850c83c9fd57e72"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method finishes the communication session with the spectrum analyzer.  <a href="#a8884f03d3075589a2850c83c9fd57e72">More...</a><br /></td></tr>
<tr class="separator:a8884f03d3075589a2850c83c9fd57e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7d78879a60f850b866386ad6101e20"><td class="memItemLeft" align="right" valign="top"><a id="a7c7d78879a60f850b866386ad6101e20"></a>
DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a7c7d78879a60f850b866386ad6101e20">GetVID</a> () const</td></tr>
<tr class="memdesc:a7c7d78879a60f850b866386ad6101e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns the Vendor ID of the spectrum analyzer. <br /></td></tr>
<tr class="separator:a7c7d78879a60f850b866386ad6101e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e03dced69c7c7c60951692894d26ce"><td class="memItemLeft" align="right" valign="top"><a id="a70e03dced69c7c7c60951692894d26ce"></a>
DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a70e03dced69c7c7c60951692894d26ce">GetPID</a> () const</td></tr>
<tr class="memdesc:a70e03dced69c7c7c60951692894d26ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns the Product ID of the spectrum analyzer. <br /></td></tr>
<tr class="separator:a70e03dced69c7c7c60951692894d26ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37854d2e596c8338c0015d8ec9120cae"><td class="memItemLeft" align="right" valign="top"><a id="a37854d2e596c8338c0015d8ec9120cae"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a37854d2e596c8338c0015d8ec9120cae">GetDevDescription</a> () const</td></tr>
<tr class="memdesc:a37854d2e596c8338c0015d8ec9120cae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns the device description (a string) of the spectrum analyzer. <br /></td></tr>
<tr class="separator:a37854d2e596c8338c0015d8ec9120cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e80df1d7f5709f2976847ee1c91a85d"><td class="memItemLeft" align="right" valign="top"><a id="a7e80df1d7f5709f2976847ee1c91a85d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a7e80df1d7f5709f2976847ee1c91a85d">IsLogged</a> () const</td></tr>
<tr class="memdesc:a7e80df1d7f5709f2976847ee1c91a85d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns a true value if the communication has been opened and a login has been performed, and a false value otherwise. <br /></td></tr>
<tr class="separator:a7e80df1d7f5709f2976847ee1c91a85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad921e08380e246d03d01b4ad080cec99"><td class="memItemLeft" align="right" valign="top"><a id="ad921e08380e246d03d01b4ad080cec99"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#ad921e08380e246d03d01b4ad080cec99">IsSweepEnabled</a> () const</td></tr>
<tr class="memdesc:ad921e08380e246d03d01b4ad080cec99"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns a true value if the streaming of sweep points has been enabled and a false otherwise. <br /></td></tr>
<tr class="separator:ad921e08380e246d03d01b4ad080cec99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6064f5888f86d0913b8c2af429bdf278"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a6064f5888f86d0913b8c2af429bdf278">SoundNewSweep</a> ()</td></tr>
<tr class="memdesc:a6064f5888f86d0913b8c2af429bdf278"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method allows to perform the a sound to state the capturing of a sweep has finished.  <a href="#a6064f5888f86d0913b8c2af429bdf278">More...</a><br /></td></tr>
<tr class="separator:a6064f5888f86d0913b8c2af429bdf278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3046fce691a5ed248e3fd647b0b043e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a3046fce691a5ed248e3fd647b0b043e8">Write</a> (const <a class="el" href="classCommand.html">Command</a> &amp;command)</td></tr>
<tr class="memdesc:a3046fce691a5ed248e3fd647b0b043e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is intended to perform all the writing operations.  <a href="#a3046fce691a5ed248e3fd647b0b043e8">More...</a><br /></td></tr>
<tr class="separator:a3046fce691a5ed248e3fd647b0b043e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c61d4d26c5aa335c6a20f469f3ec00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectranInterface.html#a63c61d4d26c5aa335c6a20f469f3ec00">Read</a> (<a class="el" href="classReply.html">Reply</a> &amp;reply)</td></tr>
<tr class="memdesc:a63c61d4d26c5aa335c6a20f469f3ec00"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is intended to perform all the reading operations.  <a href="#a63c61d4d26c5aa335c6a20f469f3ec00">More...</a><br /></td></tr>
<tr class="separator:a63c61d4d26c5aa335c6a20f469f3ec00"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The aim of this class is to manage the communication with the Aaronia Spectran device. </p>
<p>This class establishes the communication with the Aaronia Spectran device (VID=0403, PID=E8D8) and allows to write commands to the device and read its replies. Also, it allows to know the available bytes in the input buffer, purge that buffer and reset the communication with the device. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9ace3807dcbbf01313890871d6a60f51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ace3807dcbbf01313890871d6a60f51">&#9670;&nbsp;</a></span>SpectranInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SpectranInterface::SpectranInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The default class constructor. </p>
<p>This constructor initializes the internal flags, flagLogIn and flagSweepsEnabled, as false, includes the VID and PID of the spectrum analyzer in the list of possible values and, finally, it calls the method <code>OpenAndSetUp()</code>. </p>

</div>
</div>
<a id="a52592fb5fe9d7734d869540826b47325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52592fb5fe9d7734d869540826b47325">&#9670;&nbsp;</a></span>~SpectranInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SpectranInterface::~SpectranInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The class destructor. </p>
<p>The destructor carry out the logging out and the communication closing. In each operation, this method produces messages in the <code>stdout</code> if there were errors, but it never produces exceptions. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a68b1b1a6af802369cb146c69161d031d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68b1b1a6af802369cb146c69161d031d">&#9670;&nbsp;</a></span>DisableSweep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::DisableSweep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method allows to disable the streaming of sweep points. </p>
<p>To ensure the streaming is disabled at least two commands (USMEAS, 0) must be sent because the first one will receive a wrong reply as there is a delay until the spectrum analyzer stops sending sweep points (AMPFREQDAT), so the reply to first command will be mixed with the sweep points and the software will read it with errors. Because of that, this method is implemented with a loop where it is tried to disable the streaming times, up to 4 times. After the streaming is disabled successfully, the input buffer is purged. </p>

</div>
</div>
<a id="ac812a1bcaede6504f62cc544c30fffea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac812a1bcaede6504f62cc544c30fffea">&#9670;&nbsp;</a></span>EnableSweep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::EnableSweep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method allows to enable the streaming of sweep points. </p>
<p>Take into account that once the streaming the sweep points is enabled, the spectrum analyzer will send these points autonomously, i.e. the communication will not follow anymore the master-slave paradigm where the slave only sends data to the master when this sends a request. So the software must be prepared to receive and process the data stream. </p>

</div>
</div>
<a id="a44ee786fb582c5db42253ec0c96f3b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ee786fb582c5db42253ec0c96f3b8e">&#9670;&nbsp;</a></span>HardReset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::HardReset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The hard reset implies that the spectrum analyzer is turned off and then it is turned on again. </p>
<p>To start, a logout is performed, then the communication is closed, the entire RF front end is turned off sequentially, then it is waited 10 seconds, the entire front end is turned on again sequentially, and finally the communication is opened again. After the calling of this method, a login must be performed calling the method <a class="el" href="classSpectranInterface.html#a29d4a40c802f909b19014a5bfdac7db5" title="This method logs in with the spectrum analyzer, once the communication has been opened and its parame...">Initialize()</a>. </p>

</div>
</div>
<a id="a29d4a40c802f909b19014a5bfdac7db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d4a40c802f909b19014a5bfdac7db5">&#9670;&nbsp;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::Initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method logs in with the spectrum analyzer, once the communication has been opened and its parameters has been set up. </p>
<p>Firstly, this method sends two VERIFY commands to log in with the spectrum analyzer. If that operation failed, it resets the spectrum analyzer in a hard way (turn it off and then turn it on), then it tries again to send two VERIFY commands and if that failed it retries the reset and repeat this up to three times.</p>
<p>Secondly, it makes sure the streaming of sweep points is disabled. And finally, it set up the speaker volume, produces the login sounds and purge the input and output buffers. </p>

</div>
</div>
<a id="a8884f03d3075589a2850c83c9fd57e72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8884f03d3075589a2850c83c9fd57e72">&#9670;&nbsp;</a></span>LogOut()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::LogOut </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method finishes the communication session with the spectrum analyzer. </p>
<p>To ensure the logout can be carried out successfully, first, the streaming of sweep points is disabled, then the logout sound is performed and, finally, the command to logout is sent to the spectrum analyzer. </p>

</div>
</div>
<a id="a63c61d4d26c5aa335c6a20f469f3ec00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c61d4d26c5aa335c6a20f469f3ec00">&#9670;&nbsp;</a></span>Read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::Read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classReply.html">Reply</a> &amp;&#160;</td>
          <td class="paramname"><em>reply</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is intended to perform all the reading operations. </p>
<p>Before the calling of the function <code>FT_Read()</code>, there is a loop where it is queried if the number of waited bytes are available. After each query which states less bytes than which are waited, the method waits a certain time before the next query. The loop iterates a certain number of times and, after that, if the waited bytes are not available the method finishes and raises an exception. In the other hand, if the bytes are available before the last iteration, the method moves to a different loop where it is tried to read the bytes using the function <code>FT_Read()</code>. If an error occurs inside this loop, the method waits during a time and then retry the operation. If many errors occur the method finishes and raises an exception. But if all the bytes are read successfully, so then they are inserted in the <em><a class="el" href="classReply.html" title="The class Reply is intended to receive a bytes vector sent by the spectrum analyzer and to extract it...">Reply</a></em> object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reply</td><td>A <em><a class="el" href="classReply.html" title="The class Reply is intended to receive a bytes vector sent by the spectrum analyzer and to extract it...">Reply</a></em> object which states the number of bytes must be read and which receives these bytes to the extract the info from them. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a512218c4f1589c32b4fd9a0f7ad5e8cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a512218c4f1589c32b4fd9a0f7ad5e8cc">&#9670;&nbsp;</a></span>ResetSweep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::ResetSweep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method is intended to restore the streaming of sweep points to the first point which corresponds to the initial frequency (Fstart). </p>
<p>The reset of the current sweep has sense when the streaming of sweep points is enabled. </p>

</div>
</div>
<a id="a59eff163ecf77f55bba22f49ef79d909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59eff163ecf77f55bba22f49ef79d909">&#9670;&nbsp;</a></span>SoftReset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::SoftReset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The soft reset is performed using the function <code>FT_ResetDevice()</code> of the driver D2XX. </p>
<p>First, a logout is performed, then the communication is restarted using the function FT_ResetDevice() and, finally, the method sleeps 3 seconds. After calling this method the communication must be initialized again with the method <a class="el" href="classSpectranInterface.html#a29d4a40c802f909b19014a5bfdac7db5" title="This method logs in with the spectrum analyzer, once the communication has been opened and its parame...">Initialize()</a>. </p>

</div>
</div>
<a id="a6064f5888f86d0913b8c2af429bdf278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6064f5888f86d0913b8c2af429bdf278">&#9670;&nbsp;</a></span>SoundNewSweep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::SoundNewSweep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method allows to perform the a sound to state the capturing of a sweep has finished. </p>
<p>The new-sweep sound is compound of just one pulse whose duration is determined by the constant NEW_SWEEP_SOUND_DURATION. This method should be called by the object which is responsible for the capture of the sweep points and the building of the entire sweep. </p>

</div>
</div>
<a id="a3046fce691a5ed248e3fd647b0b043e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3046fce691a5ed248e3fd647b0b043e8">&#9670;&nbsp;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SpectranInterface::Write </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCommand.html">Command</a> &amp;&#160;</td>
          <td class="paramname"><em>command</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is intended to perform all the writing operations. </p>
<p>First, the method copies the bytes of the command to an auxiliary array, because the function <code>FT_Write()</code> destroys the array of bytes which is passed to it, so this is done to avoid the modification of the <em><a class="el" href="classCommand.html" title="This class builds the corresponding bytes array to send a certain command to a Aaronia Spectran V4 se...">Command</a></em> object. Then the function <code>FT_Write()</code> is called with the corresponding arguments and, finally, it is controlled if there were errors and if all bytes were written. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">command</td><td>A <em><a class="el" href="classCommand.html" title="This class builds the corresponding bytes array to send a certain command to a Aaronia Spectran V4 se...">Command</a></em> object which contains the bytes must be sent to the spectrum analyzer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/new-mauro/eclipse-cdt/workspace/RFIMS_CART/src/<a class="el" href="Spectran_8h_source.html">Spectran.h</a></li>
<li>/home/new-mauro/eclipse-cdt/workspace/RFIMS_CART/src/<a class="el" href="SpectranInterface_8cpp.html">SpectranInterface.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>

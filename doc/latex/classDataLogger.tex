\hypertarget{classDataLogger}{}\section{Data\+Logger Class Reference}
\label{classDataLogger}\index{Data\+Logger@{Data\+Logger}}


The class {\itshape \hyperlink{classDataLogger}{Data\+Logger}} is intended to handle the storing of the generated data into memory, following the C\+SV (comma-\/separated values) format.  




{\ttfamily \#include $<$Sweep\+Processing.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDataLogger_a7abebacd4747644d22982f9676466bad}{Data\+Logger} ()
\begin{DoxyCompactList}\small\item\em The unique class constructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDataLogger_a9aaff109f3e7749a0a0a0313655da50a}\label{classDataLogger_a9aaff109f3e7749a0a0a0313655da50a}} 
\hyperlink{classDataLogger_a9aaff109f3e7749a0a0a0313655da50a}{$\sim$\+Data\+Logger} ()
\begin{DoxyCompactList}\small\item\em The class destructor. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_a2ffe9fb45883c2880e1c45a4406fc22b}{Save\+Bands\+Param\+As\+C\+SV} (const std\+::vector$<$ \hyperlink{structBandParameters}{Band\+Parameters} $>$ \&bands\+Param\+Vector)
\begin{DoxyCompactList}\small\item\em This method is intended to save the bands parameters in a C\+SV file which is more adequately to be read in the remote server. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_a058ed66d04269e7d37501ecfe775c067}{Save\+Front\+End\+Param} (const \hyperlink{structFreqValues}{Freq\+Values} \&gain, const \hyperlink{structFreqValues}{Freq\+Values} \&noise\+Figure)
\begin{DoxyCompactList}\small\item\em This method is intended to save the estimated front end parameters, gain and noise figure, into the non-\/volatile memory. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_ab2063fcd87971520a5bfa5aef6d73fea}{Save\+Sweep} (const \hyperlink{structSweep}{Sweep} \&sweep)
\begin{DoxyCompactList}\small\item\em This method is intended to save a calibrated sweep into the non-\/volatile memory. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_a0c772c3529adc3759ba0e1e596500f65}{Save\+R\+FI} (const \hyperlink{structRFI}{R\+FI} \&rfi)
\begin{DoxyCompactList}\small\item\em This method is intended to save the detected \hyperlink{structRFI}{R\+FI} in the last sweep, into the non-\/volatile memory. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classDataLogger_a4fd6e432dd4348cbe3b02a0fd6969ab5}\label{classDataLogger_a4fd6e432dd4348cbe3b02a0fd6969ab5}} 
void \hyperlink{classDataLogger_a4fd6e432dd4348cbe3b02a0fd6969ab5}{Delete\+Old\+Files} () const
\begin{DoxyCompactList}\small\item\em The aim of this method is to delete the old files. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_a147fb7eaee1c38bbf57ef2d6cddf70d5}{Archive\+And\+Compress} ()
\begin{DoxyCompactList}\small\item\em The aim of this method is to prepare, archive and compress, the files which will be send to the remote server. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_ab58f4cc05f738ef757c884fe9ef131eb}{Upload\+Data} ()
\begin{DoxyCompactList}\small\item\em This method is responsible for the uploading of the data files to the remote server. \end{DoxyCompactList}\item 
void \hyperlink{classDataLogger_a98ea7aaa941bbddea8069415e1652759}{Prepare\+And\+Upload\+Data} ()
\begin{DoxyCompactList}\small\item\em This method creates a thread where the data files will be uploaded, in parallel with the capture of a new sweep. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classDataLogger_a0cabdadaf836f897a111e72ab29d42f6}\label{classDataLogger_a0cabdadaf836f897a111e72ab29d42f6}} 
void $\ast$ \hyperlink{classDataLogger_a0cabdadaf836f897a111e72ab29d42f6}{Upload\+Thread\+Func} (void $\ast$)
\begin{DoxyCompactList}\small\item\em The function which is executed by the thread which is responsible for the concurrent uploading of the data files. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The class {\itshape \hyperlink{classDataLogger}{Data\+Logger}} is intended to handle the storing of the generated data into memory, following the C\+SV (comma-\/separated values) format. 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classDataLogger_a7abebacd4747644d22982f9676466bad}\label{classDataLogger_a7abebacd4747644d22982f9676466bad}} 
\index{Data\+Logger@{Data\+Logger}!Data\+Logger@{Data\+Logger}}
\index{Data\+Logger@{Data\+Logger}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Data\+Logger()}{DataLogger()}}
{\footnotesize\ttfamily Data\+Logger\+::\+Data\+Logger (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



The unique class constructor. 

The constructor initializes all the internal attributes, checks if the corresponding folders exist and if any folder does not exist then it is created. Also, it checks if there is a shell available to be able to execute the external python script \char`\"{}client.\+py\char`\"{} to upload the data. 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classDataLogger_a147fb7eaee1c38bbf57ef2d6cddf70d5}\label{classDataLogger_a147fb7eaee1c38bbf57ef2d6cddf70d5}} 
\index{Data\+Logger@{Data\+Logger}!Archive\+And\+Compress@{Archive\+And\+Compress}}
\index{Archive\+And\+Compress@{Archive\+And\+Compress}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Archive\+And\+Compress()}{ArchiveAndCompress()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Archive\+And\+Compress (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



The aim of this method is to prepare, archive and compress, the files which will be send to the remote server. 

To archive the data files the utility \textquotesingle{}tar\textquotesingle{} is used and thr utility \textquotesingle{}lzma\textquotesingle{} is used to compress to resulting archive file. The resulting compressed archive file is name as \char`\"{}rfims\+\_\+data\+\_\+\+D\+D-\/\+M\+M-\/\+Y\+Y\+Y\+Y\+T\+H\+H\+:\+M\+M\+:\+S\+S.\+tar.\+lzma\char`\"{}, where the last part, before the extension is the timestamp of the corresponding measurement cycle. \mbox{\Hypertarget{classDataLogger_a98ea7aaa941bbddea8069415e1652759}\label{classDataLogger_a98ea7aaa941bbddea8069415e1652759}} 
\index{Data\+Logger@{Data\+Logger}!Prepare\+And\+Upload\+Data@{Prepare\+And\+Upload\+Data}}
\index{Prepare\+And\+Upload\+Data@{Prepare\+And\+Upload\+Data}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Prepare\+And\+Upload\+Data()}{PrepareAndUploadData()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Prepare\+And\+Upload\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This method creates a thread where the data files will be uploaded, in parallel with the capture of a new sweep. 

This method creates a thread where the methods {\ttfamily \hyperlink{classDataLogger_a147fb7eaee1c38bbf57ef2d6cddf70d5}{Archive\+And\+Compress()}} and {\ttfamily \hyperlink{classDataLogger_ab58f4cc05f738ef757c884fe9ef131eb}{Upload\+Data()}} are called. After the creation of the thread, the method ends and the main thread can continues with the next operations, like the moving of the antenna, the capture of a new sweep, etc. The next time this method is called, it will control if the last thread has finished, if not, the method will wait to the thread to finish, and then it will create a new thread for the uploading of the new data. \mbox{\Hypertarget{classDataLogger_a2ffe9fb45883c2880e1c45a4406fc22b}\label{classDataLogger_a2ffe9fb45883c2880e1c45a4406fc22b}} 
\index{Data\+Logger@{Data\+Logger}!Save\+Bands\+Param\+As\+C\+SV@{Save\+Bands\+Param\+As\+C\+SV}}
\index{Save\+Bands\+Param\+As\+C\+SV@{Save\+Bands\+Param\+As\+C\+SV}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Save\+Bands\+Param\+As\+C\+S\+V()}{SaveBandsParamAsCSV()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Save\+Bands\+Param\+As\+C\+SV (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \hyperlink{structBandParameters}{Band\+Parameters} $>$ \&}]{bands\+Param\+Vector }\end{DoxyParamCaption})}



This method is intended to save the bands parameters in a C\+SV file which is more adequately to be read in the remote server. 

This method should be called each time the bands\textquotesingle{} parameters are reloaded (or loaded by first time), because of the file \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/parameters/freqbands.txt was modified, to update the file \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/parameters/csv/freqbands.csv to that has the same parameters, just in a different format. The C\+SV file is generated because it is easier the bands\textquotesingle{} parameters to be loaded from a file with C\+SV format than from a file with a more human-\/readable format like freqbands.\+txt. Each time this method is called the file freqbands.\+csv is regenerated. This file is then incorporated in the archive file, in the method \hyperlink{classDataLogger_a147fb7eaee1c38bbf57ef2d6cddf70d5}{Archive\+And\+Compress()}. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bands\+Param\+Vector} & A vector with the parameters of all frequency bands. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classDataLogger_a058ed66d04269e7d37501ecfe775c067}\label{classDataLogger_a058ed66d04269e7d37501ecfe775c067}} 
\index{Data\+Logger@{Data\+Logger}!Save\+Front\+End\+Param@{Save\+Front\+End\+Param}}
\index{Save\+Front\+End\+Param@{Save\+Front\+End\+Param}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Save\+Front\+End\+Param()}{SaveFrontEndParam()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Save\+Front\+End\+Param (\begin{DoxyParamCaption}\item[{const \hyperlink{structFreqValues}{Freq\+Values} \&}]{gain,  }\item[{const \hyperlink{structFreqValues}{Freq\+Values} \&}]{noise\+Figure }\end{DoxyParamCaption})}



This method is intended to save the estimated front end parameters, gain and noise figure, into the non-\/volatile memory. 

The given front end parameters are saved in two different files\+:
\begin{DoxyItemize}
\item \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/calibration/frontendparam/gain\+\_\+\+D\+D-\/\+M\+M-\/\+Y\+Y\+Y\+Y\+T\+HH\+:MM\+:S\+S.\+csv
\item \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/calibration/frontendparam/noisefigure\+\_\+\+D\+D-\/\+M\+M-\/\+Y\+Y\+Y\+Y\+T\+HH\+:MM\+:S\+S.\+csv where D\+D-\/\+M\+M-\/\+Y\+Y\+Y\+Y\+T\+HH\+:MM\+:SS is the timestamp of the current measurement cycle.
\end{DoxyItemize}

Those files are then incorporated into the archive file which will be uploaded at the end of the measurement cycle. If the front end parameters were not estimated in a measurement cycle, then the default front end parameters are used, which are curves that were estimated in the laboratory and which are saved in the following files\+:
\begin{DoxyItemize}
\item \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/calibration/frontendparam/default/gain\+\_\+default.csv
\item \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/calibration/frontendparam/default/noisefigure\+\_\+default.csv In that case, these files are incorporated into the archive file to be uploaded. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em gain} & A structure with the estimated values of the total front end gain versus the frequency. \\
\hline
\mbox{\tt in}  & {\em noise\+Figure} & A structure with the estimated values of the total front end noise figure versus the frequency. \\
\hline
\end{DoxyParams}

\end{DoxyItemize}\mbox{\Hypertarget{classDataLogger_a0c772c3529adc3759ba0e1e596500f65}\label{classDataLogger_a0c772c3529adc3759ba0e1e596500f65}} 
\index{Data\+Logger@{Data\+Logger}!Save\+R\+FI@{Save\+R\+FI}}
\index{Save\+R\+FI@{Save\+R\+FI}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Save\+R\+F\+I()}{SaveRFI()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Save\+R\+FI (\begin{DoxyParamCaption}\item[{const \hyperlink{structRFI}{R\+FI} \&}]{rfi }\end{DoxyParamCaption})}



This method is intended to save the detected \hyperlink{structRFI}{R\+FI} in the last sweep, into the non-\/volatile memory. 

Each given structure with the \hyperlink{structRFI}{R\+FI} detected in the last sweep is saved in a different file with the filename format R\+F\+I\+\_\+x.\+csv, where \textquotesingle{}x\textquotesingle{} is an integer number between 1 and 2$\ast$(number of azimuth positions). So each file corresponds to a sweep of the measurement cycle and all the files of determined measurement cycle are in the same folder, \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/measurement/\+R\+F\+I\+\_\+\+D\+D-\/\+M\+M-\/\+Y\+Y\+Y\+Y\+T\+HH\+:MM\+:S\+S/ where the last part of the folder\textquotesingle{}s name is the timestamp of the measurement cycle. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em rfi} & A structure with \hyperlink{structRFI}{R\+FI} to be saved. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classDataLogger_ab2063fcd87971520a5bfa5aef6d73fea}\label{classDataLogger_ab2063fcd87971520a5bfa5aef6d73fea}} 
\index{Data\+Logger@{Data\+Logger}!Save\+Sweep@{Save\+Sweep}}
\index{Save\+Sweep@{Save\+Sweep}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Save\+Sweep()}{SaveSweep()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Save\+Sweep (\begin{DoxyParamCaption}\item[{const \hyperlink{structSweep}{Sweep} \&}]{sweep }\end{DoxyParamCaption})}



This method is intended to save a calibrated sweep into the non-\/volatile memory. 

The given sweep is saved in \hyperlink{Basics_8h_a0423f4cb393331ce0b9f6b3a43adcaae}{B\+A\+S\+E\+\_\+\+P\+A\+TH}/measurements/ with the filename format \char`\"{}sweep\+\_\+\+D\+D-\/\+M\+M-\/\+Y\+Y\+Y\+Y\+T\+H\+H\+:\+M\+M\+:\+S\+S.\+csv\char`\"{} where the last part is the timestamp of the measurement cycle, which correspond to the beginning of this one.

All sweeps which corresponds to the same measurement cycle are saved in the same file and the method automatically create a new file or reopen the corresponding file each time a new sweep must be saved. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sweep} & A structure with the sweep to be saved. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classDataLogger_ab58f4cc05f738ef757c884fe9ef131eb}\label{classDataLogger_ab58f4cc05f738ef757c884fe9ef131eb}} 
\index{Data\+Logger@{Data\+Logger}!Upload\+Data@{Upload\+Data}}
\index{Upload\+Data@{Upload\+Data}!Data\+Logger@{Data\+Logger}}
\subsubsection{\texorpdfstring{Upload\+Data()}{UploadData()}}
{\footnotesize\ttfamily void Data\+Logger\+::\+Upload\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This method is responsible for the uploading of the data files to the remote server. 

To upload the files the script /usr/local/client.py is called. This script try to send the archive file many times through one hour, taking into account the possibility that there is no Internet connection in the first try. If the script achieves the sending, then it wakes up the remote server to that one to read the files, and finally the script removes the local archive file. If the script ends with errors, the file is not deleted and remains in a queue waiting to be send. The idea is the uploading to perform at the end of each measurement cycle. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/new-\/mauro/eclipse-\/cdt/workspace/\+R\+F\+I\+M\+S\+\_\+\+C\+A\+R\+T/src/\hyperlink{SweepProcessing_8h}{Sweep\+Processing.\+h}\item 
/home/new-\/mauro/eclipse-\/cdt/workspace/\+R\+F\+I\+M\+S\+\_\+\+C\+A\+R\+T/src/\hyperlink{DataLogger_8cpp}{Data\+Logger.\+cpp}\end{DoxyCompactItemize}
